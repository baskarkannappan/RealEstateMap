@inherits LayoutComponentBase
@inject NavigationManager Nav

<div class="app-shell @(isMenuOpen ? "menu-open" : "menu-collapsed")">
    <header class="app-header">
        <div class="header-left">
            <button type="button"
                    class="icon-button menu-toggle"
                    @onclick="ToggleMenu"
                    aria-label="Toggle navigation">
                <span class="icon-lines" aria-hidden="true"></span>
            </button>
            <a class="brand" href="">
                <span class="brand-text">RealEstateMap</span>
            </a>
        </div>
        <div class="header-actions">
            <button type="button" class="icon-button" aria-label="Notifications">
                <span class="icon-bell" aria-hidden="true"></span>
            </button>
            <button type="button" class="profile-chip" aria-label="Account settings">
                <span class="avatar">BM</span>
                <span class="profile-text">Baska</span>
            </button>
        </div>
    </header>

    <div class="app-body">
        <aside class="app-sidebar" aria-hidden="@(!isMenuOpen)">
            <NavMenu OnNavigate="HandleNavigate" />
        </aside>
        <div class="sidebar-overlay" @onclick="CloseMenu" aria-hidden="true"></div>
        <main class="app-content">
            <article class="content @(IsMapRoute ? "content-flush" : string.Empty)">
                @Body
            </article>
        </main>
    </div>
</div>

@code {
    private bool isMenuOpen = true;

    private bool IsMapRoute => string.IsNullOrEmpty(CurrentPath) || CurrentPath.Equals("map", StringComparison.OrdinalIgnoreCase);

    private string CurrentPath => Nav.ToBaseRelativePath(Nav.Uri).TrimEnd('/');

    private void ToggleMenu()
    {
        isMenuOpen = !isMenuOpen;
    }

    private void CloseMenu()
    {
        isMenuOpen = false;
    }

    private void HandleNavigate()
    {
        isMenuOpen = false;
    }
}
